import"./modulepreload-polyfill-B5Qt9EMX.js";const j="modulepreload",N=function(o){return"/LogicCastle/"+o},A={},x=function(e,t,n){let s=Promise.resolve();if(t&&t.length>0){let _=function(g){return Promise.all(g.map(h=>Promise.resolve(h).then(m=>({status:"fulfilled",value:m}),m=>({status:"rejected",reason:m}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),l=a?.nonce||a?.getAttribute("nonce");s=_(t.map(g=>{if(g=N(g),g in A)return;A[g]=!0;const h=g.endsWith(".css"),m=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${g}"]${m}`))return;const b=document.createElement("link");if(b.rel=h?"stylesheet":j,h||(b.as="script"),b.crossOrigin="",b.href=g,l&&b.setAttribute("nonce",l),document.head.appendChild(b),h)return new Promise((U,P)=>{b.addEventListener("load",U),b.addEventListener("error",()=>P(new Error(`Unable to preload CSS for ${g}`)))})}))}function i(a){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=a,window.dispatchEvent(l),!l.defaultPrevented)throw a}return s.then(a=>{for(const l of a||[])l.status==="rejected"&&i(l.reason);return e().catch(i)})};class q{constructor(e={}){this.config={required:e.required||[],optional:e.optional||[],validateOnBind:e.validateOnBind!==!1,throwOnMissing:e.throwOnMissing!==!1},this.boundElements={},this.missingElements=[]}async bindElements(){this.boundElements={},this.missingElements=[];for(const e of this.config.required)this.bindElement(e,!0);for(const e of this.config.optional)this.bindElement(e,!1);return this.config.validateOnBind&&this.validateBindings(),this.reportBindingResults(),this.boundElements}bindElement(e,t=!1){const n=document.getElementById(e);n?this.boundElements[e]=n:(t&&this.missingElements.push(e),this.boundElements[e]=null)}validateBindings(){if(this.missingElements.length>0){const e=`Missing required DOM elements: ${this.missingElements.join(", ")}`;if(this.config.throwOnMissing)throw new Error(e)}}reportBindingResults(){const e=this.config.required.length+this.config.optional.length,t=Object.values(this.boundElements).filter(s=>s!==null).length;e-t>0&&this.missingElements.length>0}getElement(e){return this.boundElements[e]||null}hasElement(e){return this.boundElements[e]!==null&&this.boundElements[e]!==void 0}getAllElements(){return{...this.boundElements}}getBoundElements(){const e={};for(const[t,n]of Object.entries(this.boundElements))n!==null&&(e[t]=n);return e}getMissingElements(){return[...this.missingElements]}allRequiredElementsBound(){return this.missingElements.length===0}rebindElement(e,t=!1){const n=this.missingElements.indexOf(e);n>-1&&this.missingElements.splice(n,1),this.bindElement(e,t)}addElement(e,t=!1){t&&!this.config.required.includes(e)?this.config.required.push(e):!t&&!this.config.optional.includes(e)&&this.config.optional.push(e),this.bindElement(e,t)}removeElement(e){this.config.required=this.config.required.filter(t=>t!==e),this.config.optional=this.config.optional.filter(t=>t!==e),delete this.boundElements[e],this.missingElements=this.missingElements.filter(t=>t!==e)}createSafeAccessors(){const e={};for(const t of[...this.config.required,...this.config.optional])e[t]=()=>this.getElement(t),e[`${t}Exists`]=()=>this.hasElement(t),e[`${t}Safe`]=n=>{const s=this.getElement(t);return s&&typeof n=="function"?n(s):null};return e}validateGameUIStructure(){const e={hasGameBoard:this.hasElement("gameBoard"),hasGameStatus:this.hasElement("gameStatus"),hasControls:!1,hasModals:!1,warnings:[]},t=["newGameBtn","undoBtn","resetScoreBtn","helpBtn"];e.hasControls=t.some(s=>this.hasElement(s));const n=["helpModal","errorModal","gameHelpModal"];return e.hasModals=n.some(s=>this.hasElement(s)),e.hasGameBoard||e.warnings.push("No game board element found (gameBoard)"),e.hasControls||e.warnings.push("No control buttons found (newGameBtn, undoBtn, etc.)"),e}generateReport(){return{config:{...this.config},boundElements:Object.keys(this.getBoundElements()),missingElements:this.getMissingElements(),totalElements:this.config.required.length+this.config.optional.length,successRate:this.calculateSuccessRate(),validationPassed:this.allRequiredElementsBound()}}calculateSuccessRate(){const e=this.config.required.length+this.config.optional.length,t=Object.values(this.boundElements).filter(n=>n!==null).length;return e>0?Math.round(t/e*100):100}}class W{constructor(e={}){this.config={enableLogging:e.enableLogging||!1,maxListeners:e.maxListeners||50,validateEventTypes:e.validateEventTypes!==!1},this.listeners=new Map,this.eventTypes=new Set,this.isDestroyed=!1}registerEventTypes(e){e.forEach(t=>this.eventTypes.add(t)),this.config.enableLogging}on(e,t,n={}){if(this.isDestroyed)return()=>{};if(this.config.validateEventTypes&&this.eventTypes.size>0&&this.eventTypes.has(e),typeof t!="function")throw new Error(`Event callback must be a function, got ${typeof t}`);this.listeners.has(e)||this.listeners.set(e,[]);const s=this.listeners.get(e);s.length>=this.config.maxListeners;const i={callback:t,options:{once:n.once||!1,priority:n.priority||0,context:n.context||null},id:this.generateListenerId()},a=s.findIndex(l=>l.options.priority<i.options.priority);return a===-1?s.push(i):s.splice(a,0,i),this.config.enableLogging,()=>this.removeListener(e,i.id)}once(e,t,n={}){return this.on(e,t,{...n,once:!0})}removeListener(e,t){if(!this.listeners.has(e))return!1;const n=this.listeners.get(e),s=n.findIndex(i=>i.id===t);return s>-1?(n.splice(s,1),n.length===0&&this.listeners.delete(e),this.config.enableLogging,!0):!1}removeAllListeners(e){if(e){const t=this.listeners.has(e)?this.listeners.get(e).length:0;return this.listeners.delete(e),this.config.enableLogging&&t>0,t}else{const t=Array.from(this.listeners.values()).reduce((n,s)=>n+s.length,0);return this.listeners.clear(),this.config.enableLogging&&t>0,t}}emit(e,t=null){if(this.isDestroyed)return!1;if(!this.listeners.has(e))return this.config.enableLogging,!1;const n=[...this.listeners.get(e)];let s=0;this.config.enableLogging;for(const i of n)try{i.options.context?i.callback.call(i.options.context,t):i.callback(t),s++,i.options.once&&this.removeListener(e,i.id)}catch{}return this.config.enableLogging,s>0}hasListeners(e){return this.listeners.has(e)&&this.listeners.get(e).length>0}getListenerCount(e){return this.listeners.has(e)?this.listeners.get(e).length:0}getEventTypes(){return Array.from(this.listeners.keys())}generateListenerId(){return`listener_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}createNamespace(e){return{on:(t,n,s)=>this.on(`${e}:${t}`,n,s),once:(t,n,s)=>this.once(`${e}:${t}`,n,s),emit:(t,n)=>this.emit(`${e}:${t}`,n),removeAllListeners:t=>this.removeAllListeners(t?`${e}:${t}`:void 0)}}getDebugInfo(){const e={};for(const[t,n]of this.listeners)e[t]={listenerCount:n.length,listeners:n.map(s=>({id:s.id,priority:s.options.priority,once:s.options.once,hasContext:!!s.options.context}))};return{totalEventTypes:this.listeners.size,totalListeners:Array.from(this.listeners.values()).reduce((t,n)=>t+n.length,0),registeredEventTypes:Array.from(this.eventTypes),eventInfo:e,config:{...this.config},isDestroyed:this.isDestroyed}}destroy(){if(this.isDestroyed)return;const e=this.removeAllListeners();this.eventTypes.clear(),this.isDestroyed=!0,this.config.enableLogging}}class H{constructor(e,t={}){this.game=e,this.config=this.isConfigComplete(t)?t:this.mergeDefaultConfig(t),this.elements={},this.modules=new Map,this.initialized=!1,this.elementBinder=null,this.eventDispatcher=null}isConfigComplete(e){return e&&e.elements&&e.modals&&e.keyboard&&e.messages&&Array.isArray(e.elements.required)&&typeof e.modals=="object"&&typeof e.keyboard=="object"&&typeof e.messages=="object"}mergeDefaultConfig(e){const t={elements:{required:["gameBoard","gameStatus"],optional:[]},modals:{help:{id:"helpModal",closeKey:"F1"}},keyboard:{F1:"toggleHelp",Escape:"closeModal"},messages:{position:"top-right",duration:3e3,types:["info","success","error"]},animations:{duration:400,easing:"ease-in-out"}};return this.deepMerge(t,e)}deepMerge(e,t){const n={...e};for(const s in t)t[s]&&typeof t[s]=="object"&&!Array.isArray(t[s])?n[s]=this.deepMerge(e[s]||{},t[s]):n[s]=t[s];return n}async init(){if(this.initialized)return;const e=performance.now();try{const t=`${this.constructor.name}_${Date.now()}`;await this.beforeInit(),this.initializeCoreModules(),await this.bindElements(),await this.setupModules(),await this.setupEvents(),await this.setupKeyboard(),await this.afterInit(),this.initialized=!0;const n=performance.now()-e}catch(t){const n=performance.now()-e;throw this.handleInitializationError(t),t}finally{}}initializeCoreModules(){this.elementBinder=new q(this.config.elements),this.eventDispatcher=new W}async bindElements(){try{this.elements=await this.elementBinder.bindElements()}catch(e){if(e.message&&e.message.includes("Missing required DOM elements")){this.elements={},this.config.elements&&this.config.elements.required&&this.config.elements.required.forEach(t=>{this.elements[t]=null});return}throw this.elements={},new Error(`Failed to bind required DOM elements: ${e.message}`)}}async setupModules(){try{if(this.config.modals&&Object.keys(this.config.modals).length>0)try{const{ModalManager:e}=await x(async()=>{const{ModalManager:n}=await import("./ModalManager-DFHthtFA.js");return{ModalManager:n}},[]),t=new e(this.config.modals);this.modules.set("modals",t)}catch{}if(this.config.messages)try{const{MessageSystem:e}=await x(async()=>{const{MessageSystem:n}=await import("./MessageSystem-qRdWVvXR.js");return{MessageSystem:n}},[]),t=new e(this.config.messages);this.modules.set("messages",t)}catch{}}catch{}}async setupEvents(){this.setupGameEventListeners(),this.setupUIEventListeners()}async setupKeyboard(){if(this.config.keyboard&&Object.keys(this.config.keyboard).length>0)try{const{KeyboardController:e}=await x(async()=>{const{KeyboardController:n}=await import("./KeyboardController-_k43I76b.js");return{KeyboardController:n}},[]),t=new e(this.config.keyboard);this.bindKeyboardActions(t),this.modules.set("keyboard",t)}catch{}}bindKeyboardActions(e){const t={toggleHelp:()=>this.toggleModal("help"),toggleModal_help:()=>this.toggleModal("help"),toggleModal_assistance:()=>this.toggleModal("assistance"),toggleAssistance:()=>this.toggleModal("assistance"),toggleGameHelp:()=>this.toggleModal("gameHelp"),closeModal:()=>this.closeAllModals(),newGame:()=>this.newGame(),undoMove:()=>this.undoMove(),resetScore:()=>this.resetScore(),resetGame:()=>this.newGame()};for(const[n,s]of Object.entries(this.config.keyboard))t[s]&&e.register(n,s,t[s])}setupGameEventListeners(){["gameOver","newGame","move","undo"].forEach(t=>{this.game&&typeof this.game.on=="function"&&this.game.on(t,n=>this.handleGameEvent(t,n))})}setupUIEventListeners(){const e={newGameBtn:()=>this.newGame(),undoBtn:()=>this.undoMove(),resetScoreBtn:()=>this.resetScore(),helpBtn:()=>this.toggleModal("help"),assistanceBtn:()=>this.toggleModal("assistance")};for(const[n,s]of Object.entries(e))this.elements[n]&&this.elements[n].addEventListener("click",s);const t={closeHelpBtn:()=>this.hideModal("help"),closeAssistanceBtn:()=>this.hideModal("assistance")};for(const[n,s]of Object.entries(t))this.elements[n]&&this.elements[n].addEventListener("click",s)}handleGameEvent(e,t){switch(e){case"gameOver":this.onGameOver(t);break;case"newGame":this.onNewGame(t);break;case"move":this.onMove(t);break;case"undo":this.onUndo(t);break;default:}}getModule(e){const n={modal:"modals",keyboard:"keyboard",message:"messages"}[e]||e,s=this.modules.get(n);return!s&&this.initialized,s||null}showMessage(e,t="info"){const n=this.getModule("messages");n&&n.show(e,t)}hideMessage(e=null){const t=this.getModule("messages");t&&(e?t.hide(e):t.hideAll())}toggleModal(e){const t=this.getModule("modals");t&&t.toggle(e)}closeAllModals(){const e=this.getModule("modals");e&&e.hideAll()}showModal(e,t={}){const n=this.getModule("modals");return n?n.showModal(e,t):!1}hideModal(e){const t=this.getModule("modals");return t?t.hideModal(e):!1}async beforeInit(){}async afterInit(){}handleInitializationError(e){this.showMessage(`Initialization failed: ${e.message}`,"error")}newGame(){this.game&&typeof this.game.newGame=="function"?this.game.newGame():this.game&&typeof this.game.resetGame=="function"&&this.game.resetGame()}undoMove(){this.game&&typeof this.game.undoMove=="function"&&this.game.undoMove()}resetScore(){this.game&&typeof this.game.resetScores=="function"&&this.game.resetScores()}onGameOver(e){e.winner?this.showMessage(`${e.winner} has won!`,"success"):this.showMessage("Game ended in a draw","info")}onNewGame(e){this.showMessage("New game started","info")}onMove(e){}onUndo(e){this.showMessage("Move undone","info")}get isInitialized(){return this.initialized}get modalManager(){return this.getModule("modals")}get keyboardController(){return this.getModule("keyboard")}get messageSystem(){return this.getModule("messages")}getBoundElements(){return this.elements}getLoadedModules(){return Array.from(this.modules.keys())}getModuleCount(){return this.modules.size}hasModule(e){return this.modules.has(e)}getConfiguration(){return{...this.config}}getDebugInfo(){return{initialized:this.initialized,elementCount:Object.keys(this.elements).length,moduleCount:this.modules.size,loadedModules:this.getLoadedModules(),config:this.getConfiguration()}}showInfo(e){return this.showMessage(e,"info")}showSuccess(e){return this.showMessage(e,"success")}showError(e){return this.showMessage(e,"error")}showWarning(e){return this.showMessage(e,"warning")}handleResetGame(){return this.newGame()}updateConfig(e){return this.config=this.deepMerge(this.config,e),this.config}destroy(){for(const[e,t]of this.modules)t.destroy&&typeof t.destroy=="function"&&t.destroy();this.modules.clear(),this.initialized=!1}}class V{constructor(e,t,n){this.gameBoard=e,this.topCoords=t,this.bottomCoords=n,this.rows=6,this.cols=7,this.cells=[],this.discs=[],this.initialized=!1}initializeBoard(){return this.gameBoard?(this.gameBoard.innerHTML="",this.cells=[],this.discs=[],this._applyBoardStyles(),this._createBoardCells(),this.cells.length>0,this.initialized=!0,!0):!1}_applyBoardStyles(){this.gameBoard.className="grid grid-cols-7 grid-rows-6 gap-2 p-6 rounded-2xl bg-gradient-to-br from-blue-600 via-blue-700 to-blue-800 shadow-2xl max-w-2xl mx-auto aspect-[7/6]",this.gameBoard.style.backdropFilter="blur(10px)",this.gameBoard.style.background="linear-gradient(135deg, rgba(59, 130, 246, 0.8), rgba(29, 78, 216, 0.9))",this.gameBoard.style.boxShadow="0 25px 50px -12px rgba(0, 0, 0, 0.25), inset 0 1px 0 rgba(255, 255, 255, 0.1)"}_createBoardCells(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.cols;t++){const{cell:n,disc:s}=this._createCell(e,t);this.cells.push(n),this.discs.push(s),this.gameBoard.appendChild(n)}}_createCell(e,t){const n=document.createElement("div");n.className="cell game-slot flex items-center justify-center relative cursor-pointer aspect-square rounded-full bg-blue-500 border-4 border-blue-800 hover:bg-blue-400 transition-all duration-200",n.dataset.row=e,n.dataset.col=t,n.dataset.index=e*this.cols+t,n.style.background="radial-gradient(circle, rgba(59, 130, 246, 0.9), rgba(29, 78, 216, 0.8))",n.style.boxShadow="inset 0 2px 8px rgba(0, 0, 0, 0.2), 0 4px 12px rgba(0, 0, 0, 0.15)";const s=document.createElement("div");return s.className="disc empty w-[85%] h-[85%] rounded-full transition-all duration-300 relative",s.style.background="radial-gradient(circle, rgba(255, 255, 255, 0.15), rgba(255, 255, 255, 0.05))",s.style.border="1px solid rgba(255, 255, 255, 0.2)",s.style.backdropFilter="blur(8px)",s.style.boxShadow="inset 0 1px 2px rgba(255, 255, 255, 0.1)",n.appendChild(s),{cell:n,disc:s}}createCoordinateLabels(){this._ensureCoordinateContainers(),this._createTopCoordinates(),this._createBottomCoordinates()}_ensureCoordinateContainers(){this.topCoords||(this.topCoords=document.getElementById("topCoords"),!this.topCoords&&this.gameBoard?.parentElement&&(this.topCoords=this._createCoordinateContainer("topCoords",!0))),this.bottomCoords||(this.bottomCoords=document.getElementById("bottomCoords"),!this.bottomCoords&&this.gameBoard?.parentElement&&(this.bottomCoords=this._createCoordinateContainer("bottomCoords",!1)))}_createCoordinateContainer(e,t){const n=this.gameBoard.parentElement;if(!n)return null;const s=document.createElement("div");return s.id=e,s.className=`board-coords ${t?"top":"bottom"}`,t?n.insertBefore(s,this.gameBoard):n.appendChild(s),s}_createTopCoordinates(){if(this.topCoords){this._applyCoordinateGridStyles(this.topCoords),this.topCoords.innerHTML="";for(let e=1;e<=this.cols;e++){const t=this._createCoordinateLabel(e);this.topCoords.appendChild(t)}}}_createBottomCoordinates(){if(this.bottomCoords){this._applyCoordinateGridStyles(this.bottomCoords),this.bottomCoords.innerHTML="";for(let e=1;e<=this.cols;e++){const t=this._createCoordinateLabel(e);this.bottomCoords.appendChild(t)}}}_applyCoordinateGridStyles(e){Object.assign(e.style,{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:"8px",width:"100%",maxWidth:"min(80vw, calc(70vh * 7 / 6))",maxHeight:"min(70vh, calc(80vw * 6 / 7))",padding:"20px",margin:"0.25rem auto",boxSizing:"border-box"})}_createCoordinateLabel(e){const t=document.createElement("div");return t.className="coord text-center font-bold text-sm",t.dataset.col=e-1,Object.assign(t.style,{color:"#666",transition:"all 0.3s ease",padding:"0.25rem",cursor:"pointer"}),t.textContent=e,t}updateBoard(e){if(!(!this.initialized||!e)&&!(!e.initialized||typeof e.getCell!="function"))for(let t=0;t<this.rows;t++)for(let n=0;n<this.cols;n++){const s=e.getCell(t,n),i=this.getDiscAt(t,n);i&&this._updateDiscVisual(i,s)}}updateBoardVisual(e,t,n){const s=this.getCellAt(e,t);if(s){const i=s.querySelector(".disc");i&&(i.classList.remove("empty","preview"),i.classList.add(n===1?"yellow":"red"),n===1?Object.assign(i.style,{background:"#FFD700",border:"3px solid #FFA000",boxShadow:"0 2px 8px rgba(255, 215, 0, 0.6)"}):Object.assign(i.style,{background:"#F44336",border:"3px solid #D32F2F",boxShadow:"0 2px 8px rgba(244, 67, 54, 0.6)"}))}}_updateDiscVisual(e,t){t===0?(e.className="disc empty",e.style.background="transparent",e.style.border="none",e.style.boxShadow="none"):t===1?(e.className="disc yellow",Object.assign(e.style,{background:"#FFD700",border:"3px solid #FFA000",boxShadow:"0 2px 8px rgba(255, 215, 0, 0.6)"})):t===2&&(e.className="disc red",Object.assign(e.style,{background:"#F44336",border:"3px solid #D32F2F",boxShadow:"0 2px 8px rgba(244, 67, 54, 0.6)"}))}getCellAt(e,t){return this.gameBoard?.querySelector(`.game-slot[data-row="${e}"][data-col="${t}"]`)}getDiscAt(e,t){return this.getCellAt(e,t)?.querySelector(".disc")}clearBoard(){for(const e of this.discs)e.className="disc empty",e.style.background="transparent",e.style.border="none",e.style.boxShadow="none"}destroy(){this.cells=[],this.discs=[],this.initialized=!1,this.gameBoard&&(this.gameBoard.innerHTML="")}getDimensions(){return{rows:this.rows,cols:this.cols}}isInitialized(){return this.initialized}}let r;const f=new Array(128).fill(void 0);f.push(void 0,null,!0,!1);function c(o){return f[o]}let M=f.length;function d(o){M===f.length&&f.push(f.length+1);const e=M;return M=f[e],f[e]=o,e}function y(o,e){try{return o.apply(this,e)}catch(t){r.__wbindgen_export_0(d(t))}}const T=typeof TextDecoder<"u"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};typeof TextDecoder<"u"&&T.decode();let w=null;function E(){return(w===null||w.byteLength===0)&&(w=new Uint8Array(r.memory.buffer)),w}function C(o,e){return o=o>>>0,T.decode(E().subarray(o,o+e))}function K(o){o<132||(f[o]=M,M=o)}function z(o){const e=c(o);return K(o),e}let L=0;const k=typeof TextEncoder<"u"?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},Z=typeof k.encodeInto=="function"?function(o,e){return k.encodeInto(o,e)}:function(o,e){const t=k.encode(o);return e.set(t),{read:o.length,written:t.length}};function Y(o,e,t){if(t===void 0){const l=k.encode(o),_=e(l.length,1)>>>0;return E().subarray(_,_+l.length).set(l),L=l.length,_}let n=o.length,s=e(n,1)>>>0;const i=E();let a=0;for(;a<n;a++){const l=o.charCodeAt(a);if(l>127)break;i[s+a]=l}if(a!==n){a!==0&&(o=o.slice(a)),s=t(s,n,n=a+o.length*3,1)>>>0;const l=E().subarray(s+a,s+n),_=Z(o,l);a+=_.written,s=t(s,n,a,1)>>>0}return L=a,s}let p=null;function u(){return(p===null||p.buffer.detached===!0||p.buffer.detached===void 0&&p.buffer!==r.memory.buffer)&&(p=new DataView(r.memory.buffer)),p}function S(o){return o==null}function O(o,e){return o=o>>>0,E().subarray(o/1,o/1+e)}let v=null;function J(){return(v===null||v.byteLength===0)&&(v=new Uint32Array(r.memory.buffer)),v}function I(o,e){return o=o>>>0,J().subarray(o/4,o/4+e)}typeof FinalizationRegistry>"u"||new FinalizationRegistry(o=>r.__wbg_aimove_free(o>>>0,1));typeof FinalizationRegistry>"u"||new FinalizationRegistry(o=>r.__wbg_board_free(o>>>0,1));typeof FinalizationRegistry>"u"||new FinalizationRegistry(o=>r.__wbg_connect4ai_free(o>>>0,1));const $=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(o=>r.__wbg_connect4game_free(o>>>0,1));class B{static __wrap(e){e=e>>>0;const t=Object.create(B.prototype);return t.__wbg_ptr=e,$.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,$.unregister(this),e}free(){const e=this.__destroy_into_raw();r.__wbg_connect4game_free(e,0)}constructor(){const e=r.connect4game_new();return this.__wbg_ptr=e>>>0,$.register(this,this.__wbg_ptr,this),this}static new_with_starting_player(e){const t=r.connect4game_new_with_starting_player(e);return B.__wrap(t)}make_move(e){try{const i=r.__wbindgen_add_to_stack_pointer(-16);r.connect4game_make_move(i,this.__wbg_ptr,e);var t=u().getInt32(i+4*0,!0),n=u().getInt32(i+4*1,!0),s=u().getInt32(i+4*2,!0);if(s)throw z(n);return t!==0}finally{r.__wbindgen_add_to_stack_pointer(16)}}get_cell(e,t){return r.connect4game_get_cell(this.__wbg_ptr,e,t)}current_player(){return r.connect4game_current_player(this.__wbg_ptr)}winner(){const e=r.connect4game_get_winner(this.__wbg_ptr);return e===0?void 0:e}move_count(){return r.connect4game_get_move_count(this.__wbg_ptr)>>>0}is_valid_move(e){return r.connect4game_is_valid_move(this.__wbg_ptr,e)!==0}get_column_height(e){return r.connect4game_get_column_height(this.__wbg_ptr,e)>>>0}reset(){r.connect4game_newGame(this.__wbg_ptr)}reset_with_starting_player(e){r.connect4game_reset_with_starting_player(this.__wbg_ptr,e)}start_new_series(e){r.connect4game_start_new_series(this.__wbg_ptr,e)}start_new_series_with_players(e,t,n){r.connect4game_start_new_series_with_players(this.__wbg_ptr,e,t,n)}create_hypothetical_state(e){const t=r.connect4game_create_hypothetical_state(this.__wbg_ptr,e);return B.__wrap(t)}board_string(){let e,t;try{const i=r.__wbindgen_add_to_stack_pointer(-16);r.connect4game_board_string(i,this.__wbg_ptr);var n=u().getInt32(i+4*0,!0),s=u().getInt32(i+4*1,!0);return e=n,t=s,C(n,s)}finally{r.__wbindgen_add_to_stack_pointer(16),r.__wbindgen_export_1(e,t,1)}}is_draw(){return r.connect4game_is_draw(this.__wbg_ptr)!==0}is_game_over(){return r.connect4game_is_game_over(this.__wbg_ptr)!==0}get_ai_move(){const e=r.connect4game_getAIMove(this.__wbg_ptr);return e===4294967297?void 0:e}analyze_position(){const e=r.connect4game_analyze_position(this.__wbg_ptr);return G.__wrap(e)}get_game_phase(){return r.connect4game_get_game_phase(this.__wbg_ptr)}memory_usage(){return r.connect4game_memory_usage(this.__wbg_ptr)>>>0}get_current_player(){return r.connect4game_current_player(this.__wbg_ptr)}set_ai_difficulty(e){r.connect4game_set_ai_difficulty(this.__wbg_ptr,e)}get_ai_difficulty(){return r.connect4game_get_ai_difficulty(this.__wbg_ptr)}get_move_count(){return r.connect4game_get_move_count(this.__wbg_ptr)>>>0}get_winner(){const e=r.connect4game_get_winner(this.__wbg_ptr);return e===0?void 0:e}get_board(){try{const s=r.__wbindgen_add_to_stack_pointer(-16);r.connect4game_get_board(s,this.__wbg_ptr);var e=u().getInt32(s+4*0,!0),t=u().getInt32(s+4*1,!0),n=O(e,t).slice();return r.__wbindgen_export_1(e,t*1,1),n}finally{r.__wbindgen_add_to_stack_pointer(16)}}can_undo(){return r.connect4game_can_undo(this.__wbg_ptr)!==0}undo_move(){return r.connect4game_undo_move(this.__wbg_ptr)!==0}get_ai_board(){try{const s=r.__wbindgen_add_to_stack_pointer(-16);r.connect4game_get_ai_board(s,this.__wbg_ptr);var e=u().getInt32(s+4*0,!0),t=u().getInt32(s+4*1,!0),n=O(e,t).slice();return r.__wbindgen_export_1(e,t*1,1),n}finally{r.__wbindgen_add_to_stack_pointer(16)}}get_threatening_moves(e){try{const i=r.__wbindgen_add_to_stack_pointer(-16);r.connect4game_get_threatening_moves(i,this.__wbg_ptr,e);var t=u().getInt32(i+4*0,!0),n=u().getInt32(i+4*1,!0),s=I(t,n).slice();return r.__wbindgen_export_1(t,n*4,4),s}finally{r.__wbindgen_add_to_stack_pointer(16)}}get_winning_moves(e){try{const i=r.__wbindgen_add_to_stack_pointer(-16);r.connect4game_get_winning_moves(i,this.__wbg_ptr,e);var t=u().getInt32(i+4*0,!0),n=u().getInt32(i+4*1,!0),s=I(t,n).slice();return r.__wbindgen_export_1(t,n*4,4),s}finally{r.__wbindgen_add_to_stack_pointer(16)}}get_blocking_moves(e){try{const i=r.__wbindgen_add_to_stack_pointer(-16);r.connect4game_get_blocking_moves(i,this.__wbg_ptr,e);var t=u().getInt32(i+4*0,!0),n=u().getInt32(i+4*1,!0),s=I(t,n).slice();return r.__wbindgen_export_1(t,n*4,4),s}finally{r.__wbindgen_add_to_stack_pointer(16)}}evaluate_position_for_player(e){return r.connect4game_evaluate_position_for_player(this.__wbg_ptr,e)}newGame(){r.connect4game_newGame(this.__wbg_ptr)}undoMove(){return r.connect4game_undoMove(this.__wbg_ptr)!==0}getAIMove(){const e=r.connect4game_getAIMove(this.__wbg_ptr);return e===4294967297?void 0:e}}typeof FinalizationRegistry>"u"||new FinalizationRegistry(o=>r.__wbg_game_free(o>>>0,1));typeof FinalizationRegistry>"u"||new FinalizationRegistry(o=>r.__wbg_gomokugame_free(o>>>0,1));typeof FinalizationRegistry>"u"||new FinalizationRegistry(o=>r.__wbg_lgame_free(o>>>0,1));const R=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(o=>r.__wbg_positionanalysis_free(o>>>0,1));class G{static __wrap(e){e=e>>>0;const t=Object.create(G.prototype);return t.__wbg_ptr=e,R.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,R.unregister(this),e}free(){const e=this.__destroy_into_raw();r.__wbg_positionanalysis_free(e,0)}get current_player_threats(){return r.__wbg_get_aimove_row(this.__wbg_ptr)>>>0}set current_player_threats(e){r.__wbg_set_aimove_row(this.__wbg_ptr,e)}get opponent_threats(){return r.__wbg_get_aimove_col(this.__wbg_ptr)>>>0}set opponent_threats(e){r.__wbg_set_aimove_col(this.__wbg_ptr,e)}get total_pieces(){return r.__wbg_get_positionanalysis_total_pieces(this.__wbg_ptr)>>>0}set total_pieces(e){r.__wbg_set_positionanalysis_total_pieces(this.__wbg_ptr,e)}get connectivity_score(){return r.__wbg_get_positionanalysis_connectivity_score(this.__wbg_ptr)}set connectivity_score(e){r.__wbg_set_positionanalysis_connectivity_score(this.__wbg_ptr,e)}get game_phase(){return r.__wbg_get_positionanalysis_game_phase(this.__wbg_ptr)}set game_phase(e){r.__wbg_set_positionanalysis_game_phase(this.__wbg_ptr,e)}get evaluation_score(){return r.__wbg_get_positionanalysis_evaluation_score(this.__wbg_ptr)}set evaluation_score(e){r.__wbg_set_positionanalysis_evaluation_score(this.__wbg_ptr,e)}get get_current_player_threats(){return r.positionanalysis_get_current_player_threats(this.__wbg_ptr)>>>0}get get_opponent_threats(){return r.positionanalysis_get_opponent_threats(this.__wbg_ptr)>>>0}get get_total_pieces(){return r.positionanalysis_get_total_pieces(this.__wbg_ptr)>>>0}get get_connectivity_score(){return r.positionanalysis_get_connectivity_score(this.__wbg_ptr)}get get_game_phase(){return r.positionanalysis_get_game_phase(this.__wbg_ptr)}get get_evaluation_score(){return r.positionanalysis_get_evaluation_score(this.__wbg_ptr)}threat_advantage(){return r.positionanalysis_threat_advantage(this.__wbg_ptr)}is_critical(){return r.positionanalysis_is_critical(this.__wbg_ptr)!==0}summary(){let e,t;try{const i=r.__wbindgen_add_to_stack_pointer(-16);r.positionanalysis_summary(i,this.__wbg_ptr);var n=u().getInt32(i+4*0,!0),s=u().getInt32(i+4*1,!0);return e=n,t=s,C(n,s)}finally{r.__wbindgen_add_to_stack_pointer(16),r.__wbindgen_export_1(e,t,1)}}}typeof FinalizationRegistry>"u"||new FinalizationRegistry(o=>r.__wbg_reachabilityanalysis_free(o>>>0,1));typeof FinalizationRegistry>"u"||new FinalizationRegistry(o=>r.__wbg_solutionanalysis_free(o>>>0,1));typeof FinalizationRegistry>"u"||new FinalizationRegistry(o=>r.__wbg_triogame_free(o>>>0,1));typeof FinalizationRegistry>"u"||new FinalizationRegistry(o=>r.__wbg_triogamelegacy_free(o>>>0,1));async function Q(o,e){if(typeof Response=="function"&&o instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(o,e)}catch(n){if(o.headers.get("Content-Type")=="application/wasm")throw n}const t=await o.arrayBuffer();return await WebAssembly.instantiate(t,e)}else{const t=await WebAssembly.instantiate(o,e);return t instanceof WebAssembly.Instance?{instance:t,module:o}:t}}function X(){const o={};return o.wbg={},o.wbg.__wbg_buffer_609cc3eee51ed158=function(e){const t=c(e).buffer;return d(t)},o.wbg.__wbg_call_672a4d21634d4a24=function(){return y(function(e,t){const n=c(e).call(c(t));return d(n)},arguments)},o.wbg.__wbg_call_7cccdd69e0791ae2=function(){return y(function(e,t,n){const s=c(e).call(c(t),c(n));return d(s)},arguments)},o.wbg.__wbg_crypto_574e78ad8b13b65f=function(e){const t=c(e).crypto;return d(t)},o.wbg.__wbg_error_7534b8e9a36f1ab4=function(e,t){let n,s;try{n=e,s=t}finally{r.__wbindgen_export_1(n,s,1)}},o.wbg.__wbg_getRandomValues_b8f5dbd5f3995a9e=function(){return y(function(e,t){c(e).getRandomValues(c(t))},arguments)},o.wbg.__wbg_log_c222819a41e063d3=function(e){},o.wbg.__wbg_msCrypto_a61aeb35a24c1329=function(e){const t=c(e).msCrypto;return d(t)},o.wbg.__wbg_new_8a6f238a6ece86ea=function(){const e=new Error;return d(e)},o.wbg.__wbg_new_a12002a7f91c75be=function(e){const t=new Uint8Array(c(e));return d(t)},o.wbg.__wbg_newnoargs_105ed471475aaf50=function(e,t){const n=new Function(C(e,t));return d(n)},o.wbg.__wbg_newwithbyteoffsetandlength_d97e637ebe145a9a=function(e,t,n){const s=new Uint8Array(c(e),t>>>0,n>>>0);return d(s)},o.wbg.__wbg_newwithlength_a381634e90c276d4=function(e){const t=new Uint8Array(e>>>0);return d(t)},o.wbg.__wbg_node_905d3e251edff8a2=function(e){const t=c(e).node;return d(t)},o.wbg.__wbg_process_dc0fbacc7c1c06f7=function(e){const t=c(e).process;return d(t)},o.wbg.__wbg_randomFillSync_ac0988aba3254290=function(){return y(function(e,t){c(e).randomFillSync(z(t))},arguments)},o.wbg.__wbg_require_60cc747a6bc5215a=function(){return y(function(){const e=module.require;return d(e)},arguments)},o.wbg.__wbg_set_65595bdd868b3009=function(e,t,n){c(e).set(c(t),n>>>0)},o.wbg.__wbg_stack_0ed75d68575b0f3c=function(e,t){const n=c(t).stack,s=Y(n,r.__wbindgen_export_2,r.__wbindgen_export_3),i=L;u().setInt32(e+4*1,i,!0),u().setInt32(e+4*0,s,!0)},o.wbg.__wbg_static_accessor_GLOBAL_88a902d13a557d07=function(){const e=typeof global>"u"?null:global;return S(e)?0:d(e)},o.wbg.__wbg_static_accessor_GLOBAL_THIS_56578be7e9f832b0=function(){const e=typeof globalThis>"u"?null:globalThis;return S(e)?0:d(e)},o.wbg.__wbg_static_accessor_SELF_37c5d418e4bf5819=function(){const e=typeof self>"u"?null:self;return S(e)?0:d(e)},o.wbg.__wbg_static_accessor_WINDOW_5de37043a91a9c40=function(){const e=typeof window>"u"?null:window;return S(e)?0:d(e)},o.wbg.__wbg_subarray_aa9065fa9dc5df96=function(e,t,n){const s=c(e).subarray(t>>>0,n>>>0);return d(s)},o.wbg.__wbg_versions_c01dfd4722a88165=function(e){const t=c(e).versions;return d(t)},o.wbg.__wbindgen_is_function=function(e){return typeof c(e)=="function"},o.wbg.__wbindgen_is_object=function(e){const t=c(e);return typeof t=="object"&&t!==null},o.wbg.__wbindgen_is_string=function(e){return typeof c(e)=="string"},o.wbg.__wbindgen_is_undefined=function(e){return c(e)===void 0},o.wbg.__wbindgen_memory=function(){const e=r.memory;return d(e)},o.wbg.__wbindgen_number_new=function(e){return d(e)},o.wbg.__wbindgen_object_clone_ref=function(e){const t=c(e);return d(t)},o.wbg.__wbindgen_object_drop_ref=function(e){z(e)},o.wbg.__wbindgen_string_new=function(e,t){const n=C(e,t);return d(n)},o.wbg.__wbindgen_throw=function(e,t){throw new Error(C(e,t))},o}function ee(o,e){return r=o.exports,D.__wbindgen_wasm_module=e,p=null,v=null,w=null,r.__wbindgen_start(),r}async function D(o){if(r!==void 0)return r;typeof o<"u"&&Object.getPrototypeOf(o)===Object.prototype&&({module_or_path:o}=o),typeof o>"u"&&(o=new URL("/LogicCastle/assets/game_engine_bg-BVGesn8u.wasm",import.meta.url));const e=X();(typeof o=="string"||typeof Request=="function"&&o instanceof Request||typeof URL=="function"&&o instanceof URL)&&(o=fetch(o));const{instance:t,module:n}=await Q(await o,e);return ee(t,n)}class te{constructor(){this.board=null,this.initialized=!1,this.rows=6,this.cols=7,this.gameHistory=[],this.currentMoveIndex=-1,this.eventListeners=new Map,this.moveStartTime=null,this.totalMoves=0,this.averageMoveTime=0}async init(){try{await D(),this.board=new B,this.initialized=!0;const e=this.board.memory_usage(),t=84;if(e<=t){const n=((t-e)/t*100).toFixed(1)}else{const n=((e-t)/t*100).toFixed(1)}return this.emit("initialized",{memoryUsage:this.board.memory_usage()}),!0}catch(e){throw e}}makeMove(e){if(!this.initialized)throw new Error("Game not initialized");this.moveStartTime=performance.now();try{if(e<0||e>=this.cols)throw new Error(`Invalid column: ${e}. Must be 0-${this.cols-1}`);if(!this.isValidMove(e))throw new Error(`Column ${e} is full`);const t=this.board.get_current_player(),n=this.board.make_move(e),s=performance.now()-this.moveStartTime;this.totalMoves++,this.averageMoveTime=(this.averageMoveTime*(this.totalMoves-1)+s)/this.totalMoves;const i={col:e,player:t,moveNumber:this.board.get_move_count(),timestamp:Date.now(),executionTime:s};this.gameHistory.push(i),this.currentMoveIndex++;const a={col:e,player:t,board:this.getBoard(),winner:n.winner,isGameOver:n.is_game_over,moveNumber:this.board.get_move_count(),winningLine:n.winning_line,executionTime:s};if(this.emit("move",a),this.emit("moveMade",a),a.isGameOver){const l={winner:a.winner,winningLine:a.winningLine,totalMoves:this.totalMoves,averageMoveTime:this.averageMoveTime};this.emit("gameOver",l)}return a}catch(t){throw t}}isValidMove(e){if(!this.initialized||e<0||e>=this.cols)return!1;try{return this.board.is_valid_move(e)}catch{return!1}}getGameState(){return this.initialized?{board:this.board.get_board(),currentPlayer:this.board.get_current_player(),moveCount:this.board.get_move_count(),isGameOver:this.board.is_game_over(),winner:this.board.get_winner(),validMoves:this.getValidMoves(),memoryUsage:this.board.memory_usage(),performanceStats:{totalMoves:this.totalMoves,averageMoveTime:this.averageMoveTime}}:null}getBoard(){if(!this.initialized)return null;const e=this.board.get_board(),t=[];for(let n=0;n<this.rows;n++){t[n]=[];for(let s=0;s<this.cols;s++)t[n][s]=e[n*this.cols+s]}return t}getCell(e,t){if(!this.initialized||e<0||e>=this.rows||t<0||t>=this.cols)return 0;try{return this.board.get_cell(e,t)}catch{return 0}}getCurrentPlayer(){return this.initialized?this.board.get_current_player():1}getMoveCount(){return this.initialized?this.board.get_move_count():0}isGameOver(){return this.initialized?this.board.is_game_over():!1}getWinner(){return this.initialized?this.board.get_winner():null}getValidMoves(){if(!this.initialized)return[];const e=[];for(let t=0;t<this.cols;t++)this.isValidMove(t)&&e.push(t);return e}newGame(){if(!this.initialized)throw new Error("Game not initialized");try{this.board.reset(),this.gameHistory=[],this.currentMoveIndex=-1,this.totalMoves=0,this.averageMoveTime=0,this.emit("newGame",this.getGameState())}catch(e){throw e}}canUndo(){return this.initialized&&this.board.can_undo()}undoMove(){if(!this.initialized)throw new Error("Game not initialized");if(!this.canUndo())throw new Error("Cannot undo: no moves to undo");try{const e=this.getGameState();this.board.undo_move(),this.gameHistory.length>0&&(this.gameHistory.pop(),this.currentMoveIndex--);const t={previousState:e,currentState:this.getGameState()};return this.emit("undo",t),t}catch(e){throw e}}getAIBoard(){return this.initialized?this.board.get_ai_board():null}evaluatePosition(e){if(!this.initialized)return 0;try{return this.board.evaluate_position_for_player(e)}catch{return 0}}getThreateningMoves(e){if(!this.initialized)return[];try{return this.board.get_threatening_moves(e)}catch{return[]}}getWinningMoves(e){if(!this.initialized)return[];try{return this.board.get_winning_moves(e)}catch{return[]}}getBlockingMoves(e){if(!this.initialized)return[];try{return this.board.get_blocking_moves(e)}catch{return[]}}getAIMove(){if(!this.initialized)return null;try{return this.board.get_ai_move()}catch{return null}}on(e,t){this.eventListeners.has(e)||this.eventListeners.set(e,[]),this.eventListeners.get(e).push(t)}off(e,t){if(this.eventListeners.has(e)){const n=this.eventListeners.get(e),s=n.indexOf(t);s>-1&&n.splice(s,1)}}emit(e,t){if(this.eventListeners.has(e)){const n=this.eventListeners.get(e);for(const s of n)try{s(t)}catch{}}}getPerformanceStats(){const e=this.initialized?this.board.memory_usage():0,t=84;let n="0%";return this.initialized&&(e<=t?n=`${((t-e)/t*100).toFixed(1)}% savings`:n=`${((e-t)/t*100).toFixed(1)}% overhead`),{totalMoves:this.totalMoves,averageMoveTime:this.averageMoveTime,memoryUsage:e,memoryEfficiency:n}}getHistory(){return[...this.gameHistory]}exportGame(){return{history:this.getHistory(),finalState:this.getGameState(),performance:this.getPerformanceStats(),timestamp:Date.now()}}debugBoard(){if(!this.initialized)return;const e=this.getBoard();for(let t=0;t<this.rows;t++){let n=`${t+1}: `;for(let s=0;s<this.cols;s++){const i=e[t][s];n+=(i===0?".":i===1?"Y":"R")+" "}}}destroy(){this.eventListeners.clear(),this.gameHistory=[],this.initialized=!1,this.board=null}}const ne={elements:{required:["gameBoard","currentPlayerIndicator","gameStatus"],optional:["yellowScore","redScore","moveCounter","newGameBtn","undoBtn","resetScoreBtn","helpBtn","assistanceBtn","helpModal","assistanceModal","closeHelpBtn","closeAssistanceBtn","gameMode","topCoords","bottomCoords","player1-undo","player2-undo","player1-threats","player2-threats","player1-winning-moves","player2-winning-moves","player1-blocked-columns","player2-blocked-columns"]},modals:{help:{id:"helpModal",closeKey:"F1",closeOnEscape:!0,closeOnOutsideClick:!0},assistance:{id:"assistanceModal",closeKey:"F2",closeOnEscape:!0,closeOnOutsideClick:!1}},keyboard:{F1:"toggleModal_help",F2:"toggleModal_assistance",F3:"resetScore",n:"newGame",N:"newGame",u:"undoMove",U:"undoMove",r:"resetScore",R:"resetScore","Ctrl+z":"undoMove","Ctrl+Z":"undoMove","Ctrl+r":"newGame","Ctrl+R":"newGame",Escape:"closeModal"},messages:{position:"top-right",duration:3e3,maxMessages:5,types:{info:{duration:3e3},success:{duration:3e3},error:{duration:5e3},warning:{duration:4e3},win:{duration:5e3}}},game:{rows:6,cols:7,winCondition:4,animationDuration:400,aiThinkingDelay:800,dropZones:{enabled:!0,hoverPreview:!0}},assistance:{enabled:!0,players:["player1","player2"],features:["undo","threats","winning-moves","blocked-columns"],defaultSettings:{player1:{undo:!1,threats:!1,"winning-moves":!1,"blocked-columns":!1},player2:{undo:!1,threats:!1,"winning-moves":!1,"blocked-columns":!1}}},wasm:{enabled:!0,autoInitialize:!0,enhancedAI:!0},animations:{duration:400,easing:"ease-in-out",discDrop:!0,modalTransitions:!0},debug:{enableLogging:!1,logColumnClicks:!1,logKeyboardEvents:!1,logModalEvents:!1}},F={"two-player":{aiEnabled:!1,assistanceDefaults:{player1:{undo:!1,threats:!1,"winning-moves":!1,"blocked-columns":!1},player2:{undo:!1,threats:!1,"winning-moves":!1,"blocked-columns":!1}}},"vs-bot-easy":{aiEnabled:!0,aiType:"easy",aiPlayer:"red",assistanceDefaults:{player1:{undo:!0,threats:!0,"winning-moves":!1,"blocked-columns":!1},player2:{undo:!1,threats:!1,"winning-moves":!1,"blocked-columns":!1}}},"vs-bot-medium":{aiEnabled:!0,aiType:"medium",aiPlayer:"red",assistanceDefaults:{player1:{undo:!0,threats:!0,"winning-moves":!0,"blocked-columns":!1},player2:{undo:!1,threats:!1,"winning-moves":!1,"blocked-columns":!1}}},"vs-bot-hard":{aiEnabled:!0,aiType:"hard",aiPlayer:"red",assistanceDefaults:{player1:{undo:!0,threats:!0,"winning-moves":!0,"blocked-columns":!0},player2:{undo:!1,threats:!1,"winning-moves":!1,"blocked-columns":!1}}}};function se(o="two-player"){const e=F[o]||F["two-player"];return{...ne,mode:o,modeSettings:e}}class oe extends H{constructor(){const e=se("two-player"),t=new te;super(t,e),this.board=Array(6).fill(null).map(()=>Array(7).fill(0)),this.currentPlayer=1,this.gameOver=!1,this.winner=null,this.moveCount=0,this.gameHistory=[],this.scores={yellow:0,red:0},this.boardRenderer=null}async init(){try{await this.wasmGame.init()}catch{}return await super.init(),this.initializeBoardRenderer(),this.createBoard(),this.setupEventListeners(),this.updateUI(),!0}initializeBoardRenderer(){const e=document.getElementById("gameBoard"),t=document.getElementById("topCoords"),n=document.getElementById("bottomCoords");e&&(this.boardRenderer=new V(e,t,n))}createBoard(){this.boardRenderer?this.boardRenderer.initializeBoard()?this.boardRenderer.createCoordinateLabels():this.fallbackCreateBoard():this.fallbackCreateBoard()}fallbackCreateBoard(){const e=document.getElementById("gameBoard");if(e){e.innerHTML="";for(let t=0;t<6;t++)for(let n=0;n<7;n++){const s=document.createElement("div");s.className="game-slot relative bg-blue-500 rounded-full border-2 border-blue-700 cursor-pointer aspect-square flex items-center justify-center",s.dataset.row=t,s.dataset.col=n;const i=document.createElement("div");i.className="disc empty w-[85%] h-[85%] rounded-full",s.appendChild(i),e.appendChild(s)}}}setupEventListeners(){document.getElementById("gameBoard").addEventListener("click",e=>{const t=e.target.closest(".game-slot");if(t&&!this.gameOver){const n=parseInt(t.dataset.col);this.makeMove(n)}}),document.querySelectorAll(".coord").forEach((e,t)=>{e.addEventListener("click",()=>{this.gameOver||this.makeMove(t)})}),document.getElementById("newGameBtn").addEventListener("click",()=>{this.resetGame()}),document.getElementById("undoBtn").addEventListener("click",()=>{this.undoMove()}),document.getElementById("resetScoreBtn").addEventListener("click",()=>{this.resetScore()}),document.getElementById("helpBtn").addEventListener("click",()=>{this.showModal("helpModal")}),document.getElementById("assistanceBtn").addEventListener("click",()=>{this.showModal("assistanceModal")}),document.getElementById("closeHelpModal").addEventListener("click",()=>{this.hideModal("helpModal")}),document.getElementById("closeAssistanceModal").addEventListener("click",()=>{this.hideModal("assistanceModal")}),document.addEventListener("keydown",e=>{if(e.key>="1"&&e.key<="7"&&!this.gameOver){const t=parseInt(e.key)-1;this.makeMove(t)}else e.key==="n"||e.key==="N"?this.resetGame():e.key==="u"||e.key==="U"?this.undoMove():e.key==="F1"?(e.preventDefault(),this.toggleModal("helpModal")):e.key==="F2"?(e.preventDefault(),this.toggleModal("assistanceModal")):e.key==="F3"?(e.preventDefault(),this.resetScore()):e.key==="Escape"&&(this.hideModal("helpModal"),this.hideModal("assistanceModal"))}),document.getElementById("helpModal").addEventListener("click",e=>{e.target.id==="helpModal"&&this.hideModal("helpModal")}),document.getElementById("assistanceModal").addEventListener("click",e=>{e.target.id==="assistanceModal"&&this.hideModal("assistanceModal")})}makeMove(e){if(this.gameOver||e<0||e>=7)return!1;if(this.wasmGame&&this.wasmGame.initialized)try{const t=this.wasmGame.makeMove(e);this.board=t.board,this.currentPlayer=t.player===1?2:1,this.moveCount=t.moveNumber,this.gameOver=t.isGameOver,this.winner=t.winner;const n=this.findMoveRow(e,t.board);return n!==-1&&this.updateCell(n,e,t.player),t.isGameOver&&(t.winner?(this.showWin(n,e),this.updateScore()):this.showDraw()),this.updateUI(),!0}catch{}return this.legacyMakeMove(e)}findMoveRow(e,t){for(let n=5;n>=0;n--)if(t[n][e]!==0)return n;return-1}legacyMakeMove(e){let t=-1;for(let n=5;n>=0;n--)if(this.board[n][e]===0){t=n;break}return t===-1?!1:(this.gameHistory.push({row:t,col:e,player:this.currentPlayer,board:this.board.map(n=>[...n])}),this.board[t][e]=this.currentPlayer,this.moveCount++,this.updateCell(t,e,this.currentPlayer),this.checkWin(t,e)?(this.gameOver=!0,this.winner=this.currentPlayer,this.showWin(t,e),this.updateScore()):this.moveCount===42?(this.gameOver=!0,this.winner=0,this.showDraw()):this.currentPlayer=this.currentPlayer===1?2:1,this.updateUI(),!0)}checkWin(e,t){const n=this.board[e][t],s=[[0,1],[1,0],[1,1],[1,-1]];for(const[i,a]of s){let l=1;const _=[[e,t]];for(let g=1;g<4;g++){const h=e+g*i,m=t+g*a;if(h>=0&&h<6&&m>=0&&m<7&&this.board[h][m]===n)l++,_.push([h,m]);else break}for(let g=1;g<4;g++){const h=e-g*i,m=t-g*a;if(h>=0&&h<6&&m>=0&&m<7&&this.board[h][m]===n)l++,_.push([h,m]);else break}if(l>=4)return this.winningLine=_,!0}return!1}updateCell(e,t,n){if(this.boardRenderer)this.boardRenderer.updateBoardVisual(e,t,n);else{const s=document.querySelector(`[data-row="${e}"][data-col="${t}"]`);if(s){const i=s.querySelector(".disc");i&&(i.classList.remove("empty","yellow","red"),i.classList.add(n===1?"yellow":"red"))}}}showWin(e,t){const n=this.currentPlayer===1?"Spieler 1 (Gelb)":"Spieler 2 (Rot)";this.winningLine&&this.winningLine.forEach(([i,a])=>{const l=document.querySelector(`[data-row="${i}"][data-col="${a}"]`);if(l){const _=l.querySelector(".disc");_&&_.classList.add("winning-disc")}});const s=document.getElementById("gameStatus");s&&(s.textContent=`${n} gewinnt!`,s.className="font-semibold text-yellow-400")}showDraw(){const e=document.getElementById("gameStatus");e&&(e.textContent="Unentschieden!",e.className="font-semibold text-gray-400")}updateScore(){this.winner===1?this.scores.yellow++:this.winner===2&&this.scores.red++,document.getElementById("yellowScore").textContent=this.scores.yellow,document.getElementById("redScore").textContent=this.scores.red}resetScore(){this.scores={yellow:0,red:0},document.getElementById("yellowScore").textContent="0",document.getElementById("redScore").textContent="0"}undoMove(){if(this.wasmGame&&this.wasmGame.initialized&&this.wasmGame.canUndo())try{const e=this.wasmGame.undoMove();return this.board=e.currentState.board,this.currentPlayer=e.currentState.currentPlayer,this.moveCount=e.currentState.moveCount,this.gameOver=e.currentState.isGameOver,this.winner=e.currentState.winner,this.updateBoardFromState(),this.updateUI(),!0}catch{}return this.legacyUndoMove()}legacyUndoMove(){if(this.gameHistory.length===0)return!1;const e=this.gameHistory.pop();return this.board=e.board,this.currentPlayer=e.player,this.moveCount--,this.gameOver=!1,this.winner=null,this.updateBoardFromState(),this.updateUI(),!0}updateBoardFromState(){for(let e=0;e<6;e++)for(let t=0;t<7;t++){const n=document.querySelector(`[data-row="${e}"][data-col="${t}"]`);if(n){const s=n.querySelector(".disc");s&&(s.classList.remove("empty","yellow","red","winning-disc"),this.board[e][t]===0?s.classList.add("empty"):this.board[e][t]===1?s.classList.add("yellow"):this.board[e][t]===2&&s.classList.add("red"))}}}resetGame(){if(this.wasmGame&&this.wasmGame.initialized)try{this.wasmGame.newGame(),this.board=Array(6).fill(null).map(()=>Array(7).fill(0)),this.currentPlayer=1,this.gameOver=!1,this.winner=null,this.moveCount=0,this.gameHistory=[],this.winningLine=null}catch{}else this.board=Array(6).fill(null).map(()=>Array(7).fill(0)),this.currentPlayer=1,this.gameOver=!1,this.winner=null,this.moveCount=0,this.gameHistory=[],this.winningLine=null;this.boardRenderer?this.boardRenderer.clearBoard():document.querySelectorAll(".game-slot").forEach(t=>{const n=t.querySelector(".disc");n&&(n.classList.remove("yellow","red","winning-disc"),n.classList.add("empty"))}),this.updateUI()}updateUI(){const e=document.getElementById("currentPlayerIndicator");if(e){const s=e.querySelector(".player-disc"),i=e.querySelector(".player-name");s&&i&&(this.currentPlayer===1?(s.className="player-disc w-8 h-8 rounded-full mr-3 bg-gradient-to-br from-yellow-400 to-yellow-600 shadow-lg",i.textContent="Spieler 1"):(s.className="player-disc w-8 h-8 rounded-full mr-3 bg-gradient-to-br from-red-500 to-red-700 shadow-lg",i.textContent="Spieler 2"))}const t=document.getElementById("moveCounter");if(t&&(t.textContent=this.moveCount),!this.gameOver){const s=document.getElementById("gameStatus");s&&(s.textContent="Spiel läuft",s.className="font-semibold text-green-400")}const n=document.getElementById("undoBtn");n&&(n.disabled=this.gameHistory.length===0)}showModal(e){const t=document.getElementById(e);t&&(t.classList.remove("hidden"),document.body.style.overflow="hidden")}hideModal(e){const t=document.getElementById(e);t&&(t.classList.add("hidden"),document.body.style.overflow="")}toggleModal(e){const t=document.getElementById(e);t&&(t.classList.contains("hidden")?this.showModal(e):this.hideModal(e))}}(async()=>{try{const o=new oe;await o.init(),window.game=o}catch(o){const e=document.createElement("div");e.style.cssText="position: fixed; top: 20px; left: 20px; right: 20px; background: #f44336; color: white; padding: 15px; border-radius: 8px; z-index: 1000; max-width: 500px; box-shadow: 0 4px 12px rgba(0,0,0,0.3);",e.textContent=`STEP 3 Error: ${o.message}`,document.body.appendChild(e)}})();
//# sourceMappingURL=connect4-CUfPBd9w.js.map
