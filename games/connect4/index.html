<!doctype html>
<html lang="de">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>4 Gewinnt - LogicCastle</title>
    <!-- Production-optimized Tailwind CSS build -->
    <link rel="stylesheet" href="css/tailwind-built.css" />
    <!-- Legacy CSS for gradual migration -->
    <link rel="stylesheet" href="css/game.css" />
    <link rel="stylesheet" href="css/ui.css" />
    <style>
      .game-slot {
        cursor: pointer;
        transition: all 0.2s ease;
      }
      .game-slot:hover {
        transform: scale(1.05);
      }
      .disc {
        transition: all 0.5s ease;
      }
      .disc.yellow {
        background: linear-gradient(135deg, #FFD700, #FFA000) !important;
        border: 3px solid #FF8F00 !important;
        box-shadow: 0 4px 12px rgba(255, 215, 0, 0.6) !important;
      }
      .disc.red {
        background: linear-gradient(135deg, #F44336, #D32F2F) !important;
        border: 3px solid #C62828 !important;
        box-shadow: 0 4px 12px rgba(244, 67, 54, 0.6) !important;
      }
      .disc.empty {
        background: rgba(255, 255, 255, 0.1) !important;
        border: 1px solid rgba(255, 255, 255, 0.2) !important;
      }
      .winning-disc {
        animation: winningGlow 1s ease-in-out infinite;
      }
      @keyframes winningGlow {
        0%, 100% { 
          box-shadow: 0 0 20px rgba(255, 215, 0, 0.8),
                      0 0 40px rgba(255, 215, 0, 0.6),
                      inset 0 0 15px rgba(255, 255, 255, 0.3);
          transform: scale(1);
        }
        50% { 
          box-shadow: 0 0 40px rgba(255, 215, 0, 1),
                      0 0 80px rgba(255, 215, 0, 0.8),
                      inset 0 0 25px rgba(255, 255, 255, 0.5);
          transform: scale(1.1);
        }
      }
    </style>
  </head>
  <body class="min-h-screen bg-gradient-to-br from-blue-900 via-purple-900 to-indigo-900">
    <!-- Background decoration -->
    <div class="fixed inset-0 overflow-hidden pointer-events-none">
        <div class="absolute -top-40 -right-40 w-80 h-80 bg-blue-500 rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-pulse"></div>
        <div class="absolute -bottom-40 -left-40 w-80 h-80 bg-purple-500 rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-pulse" style="animation-delay: 1s;"></div>
        <div class="absolute top-40 left-1/2 w-80 h-80 bg-indigo-500 rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-pulse" style="animation-delay: 2s;"></div>
    </div>

    <div class="relative z-10" data-current-player="1">
      <!-- Header -->
      <header class="p-6 text-center">
        <div class="max-w-6xl mx-auto">
          <div class="flex items-center justify-between mb-4">
            <a href="../../index.html" class="glass px-4 py-2 rounded-xl text-white hover:bg-white hover:bg-opacity-20 transition-all duration-200">
              ← Zurück zu LogicCastle
            </a>
            <div class="glass px-4 py-2 rounded-xl">
              <label for="gameMode" class="text-white text-sm mr-2">Modus:</label>
              <select id="gameMode" class="bg-transparent text-white border-none focus:outline-none">
                <option value="two-player" class="text-gray-900">2 Spieler</option>
                <option value="vs-bot-easy" class="text-gray-900">vs Einfache KI</option>
                <option value="vs-bot-medium" class="text-gray-900">vs Mittlere KI</option>
                <option value="vs-bot-hard" class="text-gray-900">vs Schwere KI</option>
              </select>
            </div>
          </div>
          <h1 class="text-4xl md:text-6xl font-bold text-white mb-2">
            <span class="inline-block w-8 h-8 bg-gradient-to-br from-red-500 to-yellow-500 rounded-full mr-3 align-middle"></span>
            4 Gewinnt
          </h1>
          <p class="text-lg md:text-xl text-white opacity-90">Modular • BitPacked • KI-Enhanced</p>
        </div>
      </header>

      <!-- Main Game Container with Responsive Grid -->
      <main class="relative z-10 max-w-7xl mx-auto p-6">
        <div class="grid grid-cols-1 xl:grid-cols-4 gap-6">
          
          <!-- Game Board Section (3/4 width on large screens) -->
          <div class="xl:col-span-3">
            <div class="glass rounded-3xl p-8 shadow-2xl" data-current-player="1">
              <!-- Column Coordinates Top -->
              <div class="grid grid-cols-7 gap-2 mb-4 px-4" id="topCoords">
                <div class="coord text-center text-white font-bold cursor-pointer hover:bg-white hover:bg-opacity-20 py-2 rounded">1</div>
                <div class="coord text-center text-white font-bold cursor-pointer hover:bg-white hover:bg-opacity-20 py-2 rounded">2</div>
                <div class="coord text-center text-white font-bold cursor-pointer hover:bg-white hover:bg-opacity-20 py-2 rounded">3</div>
                <div class="coord text-center text-white font-bold cursor-pointer hover:bg-white hover:bg-opacity-20 py-2 rounded">4</div>
                <div class="coord text-center text-white font-bold cursor-pointer hover:bg-white hover:bg-opacity-20 py-2 rounded">5</div>
                <div class="coord text-center text-white font-bold cursor-pointer hover:bg-white hover:bg-opacity-20 py-2 rounded">6</div>
                <div class="coord text-center text-white font-bold cursor-pointer hover:bg-white hover:bg-opacity-20 py-2 rounded">7</div>
              </div>
              
              <!-- Game Board Container -->
              <div class="relative">
                <div class="game-board grid grid-cols-7 grid-rows-6 gap-2 p-4 rounded-2xl shadow-2xl bg-gradient-to-br from-blue-600 to-blue-800 aspect-[7/6] max-w-2xl mx-auto" id="gameBoard">
                  <!-- 42 cells will be generated by JavaScript -->
                </div>
                <!-- Particle Engine Canvas for Victory Celebrations -->
                <canvas id="particleCanvas" 
                        class="absolute inset-0 w-full h-full pointer-events-none z-50">
                </canvas>
              </div>
              
              <!-- Column Coordinates Bottom -->
              <div class="grid grid-cols-7 gap-2 mt-4 px-4" id="bottomCoords">
                <div class="coord text-center text-white font-bold cursor-pointer hover:bg-white hover:bg-opacity-20 py-2 rounded">1</div>
                <div class="coord text-center text-white font-bold cursor-pointer hover:bg-white hover:bg-opacity-20 py-2 rounded">2</div>
                <div class="coord text-center text-white font-bold cursor-pointer hover:bg-white hover:bg-opacity-20 py-2 rounded">3</div>
                <div class="coord text-center text-white font-bold cursor-pointer hover:bg-white hover:bg-opacity-20 py-2 rounded">4</div>
                <div class="coord text-center text-white font-bold cursor-pointer hover:bg-white hover:bg-opacity-20 py-2 rounded">5</div>
                <div class="coord text-center text-white font-bold cursor-pointer hover:bg-white hover:bg-opacity-20 py-2 rounded">6</div>
                <div class="coord text-center text-white font-bold cursor-pointer hover:bg-white hover:bg-opacity-20 py-2 rounded">7</div>
              </div>
            </div>
          </div>
          
          <!-- Game Info Sidebar (1/4 width) -->
          <div class="space-y-6">
            <!-- Current Player Status -->
            <div class="glass rounded-2xl p-6 shadow-xl">
              <h3 class="text-xl font-bold text-white mb-4">Aktueller Spieler</h3>
              <div class="flex items-center justify-center">
                <span class="player-indicator flex items-center" id="currentPlayerIndicator">
                  <span class="player-disc w-8 h-8 rounded-full mr-3 bg-gradient-to-br from-yellow-400 to-yellow-600 shadow-lg"></span>
                  <span class="player-name text-white font-semibold">Spieler 1</span>
                </span>
              </div>
            </div>

            <!-- Score Board -->
            <div class="glass rounded-2xl p-6 shadow-xl">
              <h3 class="text-xl font-bold text-white mb-4">Spielstand</h3>
              <div class="space-y-4">
                <div class="flex items-center justify-between text-white">
                  <div class="flex items-center">
                    <div class="w-4 h-4 rounded-full bg-gradient-to-br from-yellow-400 to-yellow-600 mr-2"></div>
                    <span>Gelb</span>
                  </div>
                  <span id="yellowScore" class="text-2xl font-bold text-yellow-400">0</span>
                </div>
                <div class="flex items-center justify-between text-white">
                  <div class="flex items-center">
                    <div class="w-4 h-4 rounded-full bg-gradient-to-br from-red-500 to-red-700 mr-2"></div>
                    <span>Rot</span>
                  </div>
                  <span id="redScore" class="text-2xl font-bold text-red-400">0</span>
                </div>
              </div>
            </div>

            <!-- Game Status -->
            <div class="glass rounded-2xl p-6 shadow-xl">
              <h3 class="text-xl font-bold text-white mb-4">Spiel-Info</h3>
              <div class="space-y-3 text-white">
                <div class="flex justify-between">
                  <span>Status:</span>
                  <span id="gameStatus" class="font-semibold text-green-400">Spiel läuft</span>
                </div>
                <div class="flex justify-between">
                  <span>Züge:</span>
                  <span id="moveCounter" class="font-bold">0</span>
                </div>
              </div>
            </div>

            <!-- Game Controls -->
            <div class="glass rounded-2xl p-6 shadow-xl">
              <h3 class="text-xl font-bold text-white mb-4">Steuerung</h3>
              <div class="space-y-3">
                <button id="newGameBtn" class="w-full bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white font-semibold py-3 px-4 rounded-xl transition-all duration-200 shadow-lg glass-hover">
                  🆕 Neues Spiel (N)
                </button>
                <button id="undoBtn" class="w-full glass-dark text-white font-semibold py-3 px-4 rounded-xl hover:bg-white hover:bg-opacity-10 transition-all duration-200 disabled:opacity-50" disabled>
                  ↶ Rückgängig (U)
                </button>
                <button id="resetScoreBtn" class="w-full bg-gradient-to-r from-orange-500 to-red-600 hover:from-orange-600 hover:to-red-700 text-white font-semibold py-3 px-4 rounded-xl transition-all duration-200 shadow-lg glass-hover">
                  🔄 Score zurücksetzen (F3)
                </button>
                <button id="assistanceBtn" class="w-full bg-gradient-to-r from-blue-500 to-cyan-600 hover:from-blue-600 hover:to-cyan-700 text-white font-semibold py-3 px-4 rounded-xl transition-all duration-200 shadow-lg glass-hover">
                  🎛️ Spielerhilfen (F2)
                </button>
                <button id="helpBtn" class="w-full bg-gradient-to-r from-purple-500 to-pink-600 hover:from-purple-600 hover:to-pink-700 text-white font-semibold py-3 px-4 rounded-xl transition-all duration-200 shadow-lg glass-hover">
                  ❓ Spielanleitung (F1)
                </button>
              </div>
            </div>
          </div>
        </div>

      </main>
    </div>

    <!-- Modern Player Assistance Modal -->
    <div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden" id="assistanceModal">
      <div class="glass rounded-3xl p-8 max-w-4xl mx-4 max-h-[90vh] overflow-y-auto">
        <div class="flex items-center justify-between mb-6">
          <h2 class="text-3xl font-bold text-white">🎛️ Spielerhilfen</h2>
          <button class="glass-hover rounded-xl p-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-200" id="closeAssistanceModal">
            ✕
          </button>
        </div>
        <div class="text-white">
          <p>Spielerhilfen sind in der minimalen Version deaktiviert.</p>
        </div>
      </div>
    </div>

    <!-- Help Modal -->
    <div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden" id="helpModal">
      <div class="glass rounded-3xl p-8 max-w-4xl mx-4 max-h-[90vh] overflow-y-auto">
        <div class="flex items-center justify-between mb-6">
          <h2 class="text-3xl font-bold text-white">❓ Spielanleitung</h2>
          <button class="glass-hover rounded-xl p-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-200" id="closeHelpModal">
            ✕
          </button>
        </div>
        <div class="text-white space-y-4">
          <h3 class="text-xl font-bold">🎯 Spielziel</h3>
          <p>Verbinde vier deiner Spielsteine in einer geraden Linie (horizontal, vertikal oder diagonal)!</p>
          
          <h3 class="text-xl font-bold">🎮 Steuerung</h3>
          <ul class="list-disc list-inside space-y-2">
            <li><strong>Klick:</strong> Stein in Spalte einwerfen</li>
            <li><strong>1-7:</strong> Stein in Spalte 1-7 einwerfen</li>
            <li><strong>N:</strong> Neues Spiel</li>
            <li><strong>U:</strong> Zug rückgängig</li>
            <li><strong>F1:</strong> Hilfe öffnen/schließen</li>
          </ul>
          
          <h3 class="text-xl font-bold">📋 Regeln</h3>
          <ul class="list-disc list-inside space-y-2">
            <li>Gelb beginnt</li>
            <li>Steine fallen durch die Schwerkraft nach unten</li>
            <li>4 Steine in einer Reihe gewinnen</li>
            <li>Bei vollem Brett ohne Gewinner: Unentschieden</li>
          </ul>
        </div>
      </div>
    </div>

    <script>
      // MINIMAL CONNECT4 GAME - FULLY FUNCTIONAL
      console.log('🎮 Connect4 starting...');
      
      class Connect4Game {
        constructor() {
          this.board = Array(6).fill(null).map(() => Array(7).fill(0));
          this.currentPlayer = 1; // 1 = Yellow, 2 = Red
          this.gameOver = false;
          this.winner = null;
          this.moveCount = 0;
          this.gameHistory = [];
          this.scores = { yellow: 0, red: 0 };
          
          this.init();
        }
        
        init() {
          this.createBoard();
          this.setupEventListeners();
          this.updateUI();
          console.log('✅ Connect4 initialized');
        }
        
        createBoard() {
          const gameBoard = document.getElementById('gameBoard');
          gameBoard.innerHTML = '';
          
          // Create 42 cells (6 rows x 7 cols)
          for (let row = 0; row < 6; row++) {
            for (let col = 0; col < 7; col++) {
              const cell = document.createElement('div');
              cell.className = 'game-slot relative bg-blue-500 rounded-full border-2 border-blue-700 cursor-pointer aspect-square flex items-center justify-center';
              cell.dataset.row = row;
              cell.dataset.col = col;
              
              const disc = document.createElement('div');
              disc.className = 'disc empty w-[85%] h-[85%] rounded-full';
              
              cell.appendChild(disc);
              gameBoard.appendChild(cell);
            }
          }
        }
        
        setupEventListeners() {
          // Board click handler
          document.getElementById('gameBoard').addEventListener('click', (e) => {
            const cell = e.target.closest('.game-slot');
            if (cell && !this.gameOver) {
              const col = parseInt(cell.dataset.col);
              this.makeMove(col);
            }
          });
          
          // Column coordinates click handler
          document.querySelectorAll('.coord').forEach((coord, index) => {
            coord.addEventListener('click', () => {
              if (!this.gameOver) {
                this.makeMove(index);
              }
            });
          });
          
          // Button handlers
          document.getElementById('newGameBtn').addEventListener('click', () => {
            this.resetGame();
          });
          
          document.getElementById('undoBtn').addEventListener('click', () => {
            this.undoMove();
          });
          
          document.getElementById('resetScoreBtn').addEventListener('click', () => {
            this.resetScore();
          });
          
          // Modal handlers
          document.getElementById('helpBtn').addEventListener('click', () => {
            this.showModal('helpModal');
          });
          
          document.getElementById('assistanceBtn').addEventListener('click', () => {
            this.showModal('assistanceModal');
          });
          
          document.getElementById('closeHelpModal').addEventListener('click', () => {
            this.hideModal('helpModal');
          });
          
          document.getElementById('closeAssistanceModal').addEventListener('click', () => {
            this.hideModal('assistanceModal');
          });
          
          // Keyboard controls
          document.addEventListener('keydown', (e) => {
            if (e.key >= '1' && e.key <= '7' && !this.gameOver) {
              const col = parseInt(e.key) - 1;
              this.makeMove(col);
            } else if (e.key === 'n' || e.key === 'N') {
              this.resetGame();
            } else if (e.key === 'u' || e.key === 'U') {
              this.undoMove();
            } else if (e.key === 'F1') {
              e.preventDefault();
              this.toggleModal('helpModal');
            } else if (e.key === 'F2') {
              e.preventDefault();
              this.toggleModal('assistanceModal');
            } else if (e.key === 'F3') {
              e.preventDefault();
              this.resetScore();
            } else if (e.key === 'Escape') {
              this.hideModal('helpModal');
              this.hideModal('assistanceModal');
            }
          });
          
          // Modal click outside to close
          document.getElementById('helpModal').addEventListener('click', (e) => {
            if (e.target.id === 'helpModal') {
              this.hideModal('helpModal');
            }
          });
          
          document.getElementById('assistanceModal').addEventListener('click', (e) => {
            if (e.target.id === 'assistanceModal') {
              this.hideModal('assistanceModal');
            }
          });
        }
        
        makeMove(col) {
          if (this.gameOver || col < 0 || col >= 7) return false;
          
          // Find lowest empty row in column
          let targetRow = -1;
          for (let row = 5; row >= 0; row--) {
            if (this.board[row][col] === 0) {
              targetRow = row;
              break;
            }
          }
          
          if (targetRow === -1) return false; // Column full
          
          // Save move for undo
          this.gameHistory.push({
            row: targetRow,
            col: col,
            player: this.currentPlayer,
            board: this.board.map(row => [...row])
          });
          
          // Make the move
          this.board[targetRow][col] = this.currentPlayer;
          this.moveCount++;
          
          // Update visual
          this.updateCell(targetRow, col, this.currentPlayer);
          
          // Check for win
          if (this.checkWin(targetRow, col)) {
            this.gameOver = true;
            this.winner = this.currentPlayer;
            this.showWin(targetRow, col);
            this.updateScore();
          } else if (this.moveCount === 42) {
            this.gameOver = true;
            this.winner = 0; // Draw
            this.showDraw();
          } else {
            // Switch player
            this.currentPlayer = this.currentPlayer === 1 ? 2 : 1;
          }
          
          this.updateUI();
          return true;
        }
        
        checkWin(row, col) {
          const player = this.board[row][col];
          const directions = [
            [0, 1],  // horizontal
            [1, 0],  // vertical
            [1, 1],  // diagonal /
            [1, -1]  // diagonal \
          ];
          
          for (const [dr, dc] of directions) {
            let count = 1;
            const line = [[row, col]];
            
            // Check positive direction
            for (let i = 1; i < 4; i++) {
              const r = row + i * dr;
              const c = col + i * dc;
              if (r >= 0 && r < 6 && c >= 0 && c < 7 && this.board[r][c] === player) {
                count++;
                line.push([r, c]);
              } else {
                break;
              }
            }
            
            // Check negative direction
            for (let i = 1; i < 4; i++) {
              const r = row - i * dr;
              const c = col - i * dc;
              if (r >= 0 && r < 6 && c >= 0 && c < 7 && this.board[r][c] === player) {
                count++;
                line.push([r, c]);
              } else {
                break;
              }
            }
            
            if (count >= 4) {
              this.winningLine = line;
              return true;
            }
          }
          
          return false;
        }
        
        updateCell(row, col, player) {
          const cell = document.querySelector(`[data-row="${row}"][data-col="${col}"]`);
          if (cell) {
            const disc = cell.querySelector('.disc');
            if (disc) {
              disc.classList.remove('empty', 'yellow', 'red');
              disc.classList.add(player === 1 ? 'yellow' : 'red');
            }
          }
        }
        
        showWin(row, col) {
          const winnerName = this.currentPlayer === 1 ? 'Spieler 1 (Gelb)' : 'Spieler 2 (Rot)';
          
          // Highlight winning pieces
          if (this.winningLine) {
            this.winningLine.forEach(([r, c]) => {
              const cell = document.querySelector(`[data-row="${r}"][data-col="${c}"]`);
              if (cell) {
                const disc = cell.querySelector('.disc');
                if (disc) {
                  disc.classList.add('winning-disc');
                }
              }
            });
          }
          
          // Update status
          const gameStatus = document.getElementById('gameStatus');
          if (gameStatus) {
            gameStatus.textContent = `${winnerName} gewinnt!`;
            gameStatus.className = 'font-semibold text-yellow-400';
          }
          
          console.log(`🏆 ${winnerName} gewinnt!`);
        }
        
        showDraw() {
          const gameStatus = document.getElementById('gameStatus');
          if (gameStatus) {
            gameStatus.textContent = 'Unentschieden!';
            gameStatus.className = 'font-semibold text-gray-400';
          }
          
          console.log('🤝 Unentschieden!');
        }
        
        updateScore() {
          if (this.winner === 1) {
            this.scores.yellow++;
          } else if (this.winner === 2) {
            this.scores.red++;
          }
          
          document.getElementById('yellowScore').textContent = this.scores.yellow;
          document.getElementById('redScore').textContent = this.scores.red;
        }
        
        resetScore() {
          this.scores = { yellow: 0, red: 0 };
          document.getElementById('yellowScore').textContent = '0';
          document.getElementById('redScore').textContent = '0';
          console.log('🔄 Score reset');
        }
        
        undoMove() {
          if (this.gameHistory.length === 0) return false;
          
          const lastMove = this.gameHistory.pop();
          this.board = lastMove.board;
          this.currentPlayer = lastMove.player;
          this.moveCount--;
          this.gameOver = false;
          this.winner = null;
          
          // Update all cells
          for (let row = 0; row < 6; row++) {
            for (let col = 0; col < 7; col++) {
              const cell = document.querySelector(`[data-row="${row}"][data-col="${col}"]`);
              if (cell) {
                const disc = cell.querySelector('.disc');
                if (disc) {
                  disc.classList.remove('empty', 'yellow', 'red', 'winning-disc');
                  if (this.board[row][col] === 0) {
                    disc.classList.add('empty');
                  } else if (this.board[row][col] === 1) {
                    disc.classList.add('yellow');
                  } else if (this.board[row][col] === 2) {
                    disc.classList.add('red');
                  }
                }
              }
            }
          }
          
          this.updateUI();
          return true;
        }
        
        resetGame() {
          this.board = Array(6).fill(null).map(() => Array(7).fill(0));
          this.currentPlayer = 1;
          this.gameOver = false;
          this.winner = null;
          this.moveCount = 0;
          this.gameHistory = [];
          this.winningLine = null;
          
          // Reset all cells
          const cells = document.querySelectorAll('.game-slot');
          cells.forEach(cell => {
            const disc = cell.querySelector('.disc');
            if (disc) {
              disc.classList.remove('yellow', 'red', 'winning-disc');
              disc.classList.add('empty');
            }
          });
          
          this.updateUI();
          console.log('🔄 New game started');
        }
        
        updateUI() {
          // Update current player indicator
          const indicator = document.getElementById('currentPlayerIndicator');
          if (indicator) {
            const disc = indicator.querySelector('.player-disc');
            const name = indicator.querySelector('.player-name');
            if (disc && name) {
              if (this.currentPlayer === 1) {
                disc.className = 'player-disc w-8 h-8 rounded-full mr-3 bg-gradient-to-br from-yellow-400 to-yellow-600 shadow-lg';
                name.textContent = 'Spieler 1';
              } else {
                disc.className = 'player-disc w-8 h-8 rounded-full mr-3 bg-gradient-to-br from-red-500 to-red-700 shadow-lg';
                name.textContent = 'Spieler 2';
              }
            }
          }
          
          // Update move counter
          const moveCounter = document.getElementById('moveCounter');
          if (moveCounter) {
            moveCounter.textContent = this.moveCount;
          }
          
          // Update game status if not game over
          if (!this.gameOver) {
            const gameStatus = document.getElementById('gameStatus');
            if (gameStatus) {
              gameStatus.textContent = 'Spiel läuft';
              gameStatus.className = 'font-semibold text-green-400';
            }
          }
          
          // Update undo button
          const undoBtn = document.getElementById('undoBtn');
          if (undoBtn) {
            undoBtn.disabled = this.gameHistory.length === 0;
          }
        }
        
        showModal(modalId) {
          const modal = document.getElementById(modalId);
          if (modal) {
            modal.classList.remove('hidden');
            document.body.style.overflow = 'hidden';
          }
        }
        
        hideModal(modalId) {
          const modal = document.getElementById(modalId);
          if (modal) {
            modal.classList.add('hidden');
            document.body.style.overflow = '';
          }
        }
        
        toggleModal(modalId) {
          const modal = document.getElementById(modalId);
          if (modal) {
            if (modal.classList.contains('hidden')) {
              this.showModal(modalId);
            } else {
              this.hideModal(modalId);
            }
          }
        }
      }
      
      // Initialize game when DOM is ready
      document.addEventListener('DOMContentLoaded', () => {
        try {
          const game = new Connect4Game();
          window.game = game; // For debugging
          
          console.log('🎮 Connect4 ready!');
        } catch (error) {
          console.error('❌ Connect4 initialization error:', error);
          
          // Show error message
          const errorDiv = document.createElement('div');
          errorDiv.style.cssText = 'position: fixed; top: 20px; left: 20px; right: 20px; background: #f44336; color: white; padding: 15px; border-radius: 8px; z-index: 1000; max-width: 500px; box-shadow: 0 4px 12px rgba(0,0,0,0.3);';
          errorDiv.textContent = `Fehler: ${error.message}`;
          document.body.appendChild(errorDiv);
        }
      });
    </script>
  </body>
</html>