<!doctype html>
<html lang="de">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>4 Gewinnt - LogicCastle</title>
    <link rel="stylesheet" href="css/game.css" />
    <link rel="stylesheet" href="css/ui.css" />
  </head>
  <body>
    <div class="game-container">
      <header class="game-header">
        <a href="../../index.html" class="back-button" title="ZurÃ¼ck zur Hauptseite (Strg+Backspace)"
          >â† ZurÃ¼ck (Strg+âŒ«)</a
        >
        <h1>ğŸ”´ 4 Gewinnt</h1>
        <div class="game-mode-selector">
          <label for="gameModeSelect">Spielmodus:</label>
          <select id="gameModeSelect" class="mode-select">
            <option value="two-player">ğŸ‘¥ 2 Spieler</option>
            <option value="vs-bot-easy">ğŸ¤– vs Bot (Einfach)</option>
            <option value="vs-bot-medium">ğŸ¤– vs Bot (Mittel)</option>
            <option value="vs-bot-strong">ğŸ§  vs Bot (Stark)</option>
            <option value="vs-bot-expert">ğŸ”¥ vs Bot (Expert)</option>
          </select>
        </div>
      </header>

      <main class="game-main">
        <div class="game-info">
          <div class="current-player">
            <span class="player-indicator" id="currentPlayerIndicator">
              <span class="player-stone red"></span>
              <span class="player-name">ğŸ”´</span>
            </span>
          </div>
          <div class="game-status" id="gameStatus">Spiel lÃ¤uft...</div>
          <div class="score-board">
            <div class="score red">
              <span class="score-label">ğŸ”´</span>
              <span class="score-value" id="redScore">0</span>
            </div>
            <div class="score yellow">
              <span class="score-label">ğŸŸ¡</span>
              <span class="score-value" id="yellowScore">0</span>
            </div>
          </div>
        </div>

        <div class="game-board-container">
          <div class="column-indicators" id="columnIndicators">
            <div class="column-indicator" data-col="0">1</div>
            <div class="column-indicator" data-col="1">2</div>
            <div class="column-indicator" data-col="2">3</div>
            <div class="column-indicator" data-col="3">4</div>
            <div class="column-indicator" data-col="4">5</div>
            <div class="column-indicator" data-col="5">6</div>
            <div class="column-indicator" data-col="6">7</div>
          </div>

          <div class="game-board" id="gameBoard">
            <!-- 6 rows Ã— 7 columns = 42 cells -->
            <!-- Generated dynamically by JavaScript -->
          </div>

          <div class="hints-overlay" id="hintsOverlay" style="display: none">
            <!-- Hints will be shown here -->
          </div>
        </div>

        <div class="game-controls">
          <button class="btn btn-primary" id="newGameBtn" tabindex="7" title="Neues Spiel starten (F5, Strg+R, Strg+N)">
            ğŸ® Neues Spiel (F5)
          </button>
          <button class="btn btn-outline" id="resetScoreBtn" tabindex="8" title="Spielstand zurÃ¼cksetzen (F10)">
            ğŸ“Š Score zurÃ¼cksetzen (F10)
          </button>
          <button
            class="btn btn-secondary"
            id="undoBtn"
            tabindex="9"
            disabled
            title="Letzten Zug rÃ¼ckgÃ¤ngig machen (F9, Strg+Z, Strg+U)"
          >
            â†©ï¸ RÃ¼ckgÃ¤ngig (F9)
          </button>
          <button class="btn btn-warning" id="hintsBtn" tabindex="10" title="Spielerhilfen Ã¶ffnen/schlieÃŸen (F2)">
            ğŸ”§ Spielerhilfen (F2)
          </button>
          <button class="btn btn-info" id="helpBtn" tabindex="11" title="Spielanleitung Ã¶ffnen/schlieÃŸen (F1)">
            â“ Spielanleitung (F1)
          </button>
        </div>

        <div class="help-panel" id="helpPanel" style="display: none">
          <h3>Hilfen</h3>
          <div class="help-content">
            <div class="threat-warning" id="threatWarning" style="display: none">âš ï¸ Achtung: Gegner kann gewinnen!</div>
            <div class="strategy-hint" id="strategyHint" style="display: none">
              ğŸ’¡ Tipp: Spiele in der Mitte fÃ¼r bessere Chancen
            </div>
          </div>
        </div>
      </main>
    </div>

    <!-- Help Modal -->
    <div class="modal-overlay" id="helpModal">
      <div class="modal help-modal">
        <h2>ğŸ® 4 Gewinnt - Spielanleitung</h2>

        <div class="help-content">
          <div class="help-section">
            <h3>ğŸ¯ Spielziel</h3>
            <p>
              Verbinde vier deiner Steine in einer Reihe (horizontal, vertikal oder diagonal), bevor dein Gegner es
              schafft!
            </p>
          </div>

          <div class="help-section">
            <h3>ğŸ® Steuerung</h3>
            <div class="control-group">
              <h4>ğŸ–±ï¸ Maus/Touch:</h4>
              <ul>
                <li><strong>1. Klick:</strong> Spalte auswÃ¤hlen (weiÃŸe Umrandung)</li>
                <li><strong>2. Klick:</strong> Stein in die Spalte fallen lassen</li>
                <li>Klicke auf Spalten-Nummer oder irgendwo in der Spalte</li>
              </ul>
            </div>

            <div class="control-group">
              <h4>âŒ¨ï¸ Tastatur:</h4>
              <ul>
                <li><strong>1-7:</strong> Spalte auswÃ¤hlen</li>
                <li><strong>Leertaste:</strong> Stein fallen lassen</li>
                <li><strong>ESC:</strong> Auswahl zurÃ¼cksetzen</li>
              </ul>
            </div>

            <div class="control-group">
              <h4>ğŸ”§ Funktionstasten:</h4>
              <ul>
                <li><strong>F1:</strong> Diese Hilfe Ã¶ffnen/schlieÃŸen</li>
                <li><strong>F2:</strong> Spielerhilfen Ã¶ffnen/schlieÃŸen</li>
                <li><strong>F5:</strong> Neues Spiel</li>
                <li><strong>F9:</strong> Zug rÃ¼ckgÃ¤ngig</li>
                <li><strong>F10:</strong> Score zurÃ¼cksetzen</li>
              </ul>
            </div>

            <div class="control-group">
              <h4>âŒ¨ï¸ Tastenkombinationen:</h4>
              <ul>
                <li><strong>Strg+R / Strg+N:</strong> Neues Spiel</li>
                <li><strong>Strg+Z / Strg+U:</strong> Zug rÃ¼ckgÃ¤ngig</li>
                <li><strong>Strg+Backspace:</strong> ZurÃ¼ck zur Hauptseite</li>
              </ul>
            </div>
          </div>

          <div class="help-section">
            <h3>ğŸ¤– Spielmodi</h3>
            <ul>
              <li><strong>2 Spieler:</strong> Spiele gegen einen Freund</li>
              <li><strong>2 Spieler mit Hilfen:</strong> Erhalte strategische Tipps</li>
              <li><strong>vs Bot (Einfach):</strong> KI mit grundlegenden Strategien</li>
              <li><strong>vs Bot (Mittel):</strong> KI mit fortgeschrittenen Strategien</li>
              <li><strong>vs Bot (Stark):</strong> Erweiterte Monte Carlo KI - stÃ¤rkster Bot</li>
            </ul>
          </div>

          <div class="help-section">
            <h3>ğŸ’¡ Strategietipps</h3>
            <ul>
              <li>Spiele in der Mitte (Spalte 4) fÃ¼r bessere Kontrolle</li>
              <li>Blockiere gegnerische Bedrohungen</li>
              <li>Versuche "ZwickmÃ¼hlen" zu bauen (mehrere GewinnmÃ¶glichkeiten gleichzeitig)</li>
              <li>Achte auf vertikale Fallen - baue nicht zu hoch in einer Spalte</li>
              <li>Plane mehrere ZÃ¼ge im Voraus</li>
            </ul>
          </div>
        </div>

        <div class="modal-buttons">
          <button class="btn btn-primary" id="closeHelpBtn">Verstanden!</button>
        </div>
      </div>
    </div>

    <!-- Hints Modal -->
    <div class="modal-overlay" id="hintsModal">
      <div class="modal hints-modal">
        <h2>ğŸ”§ Spielerhilfen</h2>

        <div class="hints-content">
          <div class="help-section">
            <p>
              Aktiviere visuelle Hilfen fÃ¼r besseres SpielverstÃ¤ndnis. Die Hilfen erscheinen als farbige Markierungen
              auf dem Spielfeld.
            </p>
          </div>

          <div class="help-table-container">
            <table class="help-table">
              <thead>
                <tr>
                  <th>Farbe</th>
                  <th>Level 0<br /><small>GewinnzÃ¼ge</small></th>
                  <th>Level 1<br /><small>Bedrohungen</small></th>
                  <th>Level 2<br /><small>Fallen</small></th>
                  <th>RÃ¼ckgÃ¤ngig<br /><small>ZÃ¼ge widerrufen</small></th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="player-label">ğŸ”´</td>
                  <td class="help-cell">
                    <input
                      type="checkbox"
                      id="helpPlayer1Level0"
                      class="help-checkbox-input"
                      tabindex="1"
                      accesskey="1"
                    />
                    <label for="helpPlayer1Level0" class="help-checkbox-label"></label>
                  </td>
                  <td class="help-cell">
                    <input
                      type="checkbox"
                      id="helpPlayer1Level1"
                      class="help-checkbox-input"
                      tabindex="2"
                      accesskey="2"
                    />
                    <label for="helpPlayer1Level1" class="help-checkbox-label"></label>
                  </td>
                  <td class="help-cell">
                    <input
                      type="checkbox"
                      id="helpPlayer1Level2"
                      class="help-checkbox-input"
                      tabindex="3"
                      accesskey="3"
                    />
                    <label for="helpPlayer1Level2" class="help-checkbox-label"></label>
                  </td>
                  <td class="help-cell">
                    <input
                      type="checkbox"
                      id="undoEnabledPlayer1"
                      class="help-checkbox-input"
                      tabindex="7"
                      accesskey="7"
                    />
                    <label for="undoEnabledPlayer1" class="help-checkbox-label"></label>
                  </td>
                </tr>
                <tr>
                  <td class="player-label">ğŸŸ¡</td>
                  <td class="help-cell">
                    <input
                      type="checkbox"
                      id="helpPlayer2Level0"
                      class="help-checkbox-input"
                      tabindex="4"
                      accesskey="4"
                    />
                    <label for="helpPlayer2Level0" class="help-checkbox-label"></label>
                  </td>
                  <td class="help-cell">
                    <input
                      type="checkbox"
                      id="helpPlayer2Level1"
                      class="help-checkbox-input"
                      tabindex="5"
                      accesskey="5"
                    />
                    <label for="helpPlayer2Level1" class="help-checkbox-label"></label>
                  </td>
                  <td class="help-cell">
                    <input
                      type="checkbox"
                      id="helpPlayer2Level2"
                      class="help-checkbox-input"
                      tabindex="6"
                      accesskey="6"
                    />
                    <label for="helpPlayer2Level2" class="help-checkbox-label"></label>
                  </td>
                  <td class="help-cell">
                    <input
                      type="checkbox"
                      id="undoEnabledPlayer2"
                      class="help-checkbox-input"
                      tabindex="8"
                      accesskey="8"
                    />
                    <label for="undoEnabledPlayer2" class="help-checkbox-label"></label>
                  </td>
                </tr>
              </tbody>
            </table>

            <div class="help-legend">
              <div class="legend-item"><strong>Level 0:</strong> Erkennt eigene Gewinnchancen (grÃ¼n)</div>
              <div class="legend-item"><strong>Level 1:</strong> Blockiert gegnerische Bedrohungen (rot)</div>
              <div class="legend-item"><strong>Level 2:</strong> Vermeidet Fallen (gelb)</div>
              <div class="legend-item">
                <strong>RÃ¼ckgÃ¤ngig:</strong> Erlaubt ZÃ¼ge zu widerrufen (nur wenn aktiviert)
              </div>
            </div>
          </div>
        </div>

        <div class="modal-buttons">
          <button class="btn btn-primary" id="closeHintsBtn">SchlieÃŸen</button>
        </div>
      </div>
    </div>

    <script src="js/game.js"></script>
    <script src="js/fork-detection.js"></script>
    <script src="js/ai.js"></script>
    <script src="js/helpers.js"></script>
    <script src="js/ui.js"></script>
    <script>
      // Initialize game when DOM is loaded
      document.addEventListener('DOMContentLoaded', function () {
        window.game = new Connect4Game();
        window.ui = new Connect4UI(window.game);
        window.ui.init();

        // Debug info
        console.log('ğŸ® Connect4 initialized');
        console.log('Game:', window.game);
        console.log('UI:', window.ui);
        console.log('Helpers:', window.ui.helpers);
      });
    </script>
  </body>
</html>
